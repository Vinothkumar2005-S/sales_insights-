{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "7c86ed91-ceea-4890-9166-778312343386",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0.1</th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>order_no</th>\n",
       "      <th>Customer_ID</th>\n",
       "      <th>Product_ID</th>\n",
       "      <th>Transaction_ID</th>\n",
       "      <th>Purchase_quantity</th>\n",
       "      <th>Average_values</th>\n",
       "      <th>Most_Frequent_Category</th>\n",
       "      <th>Time_Between_Purchases</th>\n",
       "      <th>Region</th>\n",
       "      <th>Churn_Probability</th>\n",
       "      <th>Lifetime_Value</th>\n",
       "      <th>Launch_Date</th>\n",
       "      <th>Peak_Sales_Date</th>\n",
       "      <th>Season</th>\n",
       "      <th>Preferred_Purchase_Times</th>\n",
       "      <th>Retention_Strategy</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>CUST_9HOS83</td>\n",
       "      <td>PROD_IK97D1</td>\n",
       "      <td>TRANS_II1DZG</td>\n",
       "      <td>17</td>\n",
       "      <td>172.57</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>45</td>\n",
       "      <td>South America</td>\n",
       "      <td>0.98</td>\n",
       "      <td>952.81</td>\n",
       "      <td>2020-03-14</td>\n",
       "      <td>2023-09-11</td>\n",
       "      <td>Winter</td>\n",
       "      <td>Afternoon</td>\n",
       "      <td>Loyalty Program</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>CUST_AJU17N</td>\n",
       "      <td>PROD_UNN7KP</td>\n",
       "      <td>TRANS_9HJF7I</td>\n",
       "      <td>10</td>\n",
       "      <td>64.89</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>6</td>\n",
       "      <td>South America</td>\n",
       "      <td>0.66</td>\n",
       "      <td>5427.51</td>\n",
       "      <td>2022-10-15</td>\n",
       "      <td>2023-01-02</td>\n",
       "      <td>Spring</td>\n",
       "      <td>Afternoon</td>\n",
       "      <td>Discount</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>CUST_11XNYF</td>\n",
       "      <td>PROD_0XEW2W</td>\n",
       "      <td>TRANS_OT96OM</td>\n",
       "      <td>3</td>\n",
       "      <td>120.38</td>\n",
       "      <td>Sports</td>\n",
       "      <td>23</td>\n",
       "      <td>Asia</td>\n",
       "      <td>0.60</td>\n",
       "      <td>3994.80</td>\n",
       "      <td>2021-11-30</td>\n",
       "      <td>2023-04-06</td>\n",
       "      <td>Winter</td>\n",
       "      <td>Evening</td>\n",
       "      <td>Loyalty Program</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>CUST_IGH8G3</td>\n",
       "      <td>PROD_3IIAJN</td>\n",
       "      <td>TRANS_45V00G</td>\n",
       "      <td>12</td>\n",
       "      <td>70.34</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>5</td>\n",
       "      <td>North America</td>\n",
       "      <td>0.78</td>\n",
       "      <td>4880.01</td>\n",
       "      <td>2022-03-20</td>\n",
       "      <td>2023-03-23</td>\n",
       "      <td>Spring</td>\n",
       "      <td>Evening</td>\n",
       "      <td>Discount</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>CUST_OK6PUM</td>\n",
       "      <td>PROD_VMIWD2</td>\n",
       "      <td>TRANS_ZAK760</td>\n",
       "      <td>18</td>\n",
       "      <td>42.39</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>10</td>\n",
       "      <td>North America</td>\n",
       "      <td>0.52</td>\n",
       "      <td>8557.70</td>\n",
       "      <td>2022-11-09</td>\n",
       "      <td>2023-10-28</td>\n",
       "      <td>Spring</td>\n",
       "      <td>Morning</td>\n",
       "      <td>Discount</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Unnamed: 0.1  Unnamed: 0  order_no  Customer_ID   Product_ID  \\\n",
       "0             0           0         0  CUST_9HOS83  PROD_IK97D1   \n",
       "1             1           1         1  CUST_AJU17N  PROD_UNN7KP   \n",
       "2             2           2         2  CUST_11XNYF  PROD_0XEW2W   \n",
       "3             3           3         3  CUST_IGH8G3  PROD_3IIAJN   \n",
       "4             4           4         4  CUST_OK6PUM  PROD_VMIWD2   \n",
       "\n",
       "  Transaction_ID  Purchase_quantity  Average_values Most_Frequent_Category  \\\n",
       "0   TRANS_II1DZG                 17          172.57            Electronics   \n",
       "1   TRANS_9HJF7I                 10           64.89               Clothing   \n",
       "2   TRANS_OT96OM                  3          120.38                 Sports   \n",
       "3   TRANS_45V00G                 12           70.34               Clothing   \n",
       "4   TRANS_ZAK760                 18           42.39            Electronics   \n",
       "\n",
       "   Time_Between_Purchases         Region  Churn_Probability  Lifetime_Value  \\\n",
       "0                      45  South America               0.98          952.81   \n",
       "1                       6  South America               0.66         5427.51   \n",
       "2                      23           Asia               0.60         3994.80   \n",
       "3                       5  North America               0.78         4880.01   \n",
       "4                      10  North America               0.52         8557.70   \n",
       "\n",
       "  Launch_Date Peak_Sales_Date  Season Preferred_Purchase_Times  \\\n",
       "0  2020-03-14      2023-09-11  Winter                Afternoon   \n",
       "1  2022-10-15      2023-01-02  Spring                Afternoon   \n",
       "2  2021-11-30      2023-04-06  Winter                  Evening   \n",
       "3  2022-03-20      2023-03-23  Spring                  Evening   \n",
       "4  2022-11-09      2023-10-28  Spring                  Morning   \n",
       "\n",
       "  Retention_Strategy  \n",
       "0    Loyalty Program  \n",
       "1           Discount  \n",
       "2    Loyalty Program  \n",
       "3           Discount  \n",
       "4           Discount  "
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import matplotlib as plt\n",
    "df =pd.read_csv(r\"E:\\data sets\\sales_and_customer_insights.csv\")\n",
    "df.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "088f9a55-6b4f-4943-bf9c-522243d36c9f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Unnamed: 0.1                  int64\n",
       "Unnamed: 0                    int64\n",
       "order_no                      int64\n",
       "Customer_ID                  object\n",
       "Product_ID                   object\n",
       "Transaction_ID               object\n",
       "Purchase_quantity             int64\n",
       "Average_values              float64\n",
       "Most_Frequent_Category       object\n",
       "Time_Between_Purchases        int64\n",
       "Region                       object\n",
       "Churn_Probability           float64\n",
       "Lifetime_Value              float64\n",
       "Launch_Date                  object\n",
       "Peak_Sales_Date              object\n",
       "Season                       object\n",
       "Preferred_Purchase_Times     object\n",
       "Retention_Strategy           object\n",
       "split_text                   object\n",
       "dtype: object"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "\n",
    "\n",
    "df3 = df1.loc[9999]\n",
    "df3\n",
    "\n",
    "df.shape\n",
    "df.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "id": "0440e74a-1f2d-4619-b379-1008357a266c",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Unnamed: 0.1                0\n",
       "Unnamed: 0                  0\n",
       "order_no                    0\n",
       "Customer_ID                 0\n",
       "Product_ID                  0\n",
       "Transaction_ID              0\n",
       "Purchase_quantity           0\n",
       "Average_values              0\n",
       "Most_Frequent_Category      0\n",
       "Time_Between_Purchases      0\n",
       "Region                      0\n",
       "Churn_Probability           0\n",
       "Lifetime_Value              0\n",
       "Launch_Date                 0\n",
       "Peak_Sales_Date             0\n",
       "Season                      0\n",
       "Preferred_Purchase_Times    0\n",
       "Retention_Strategy          0\n",
       "split_text                  0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 44,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "## handling missing values \n",
    "df.dropna().sum()\n",
    "df1 = df.drop(columns = ['Unnamed: 0.1','Unnamed: 0'])\n",
    "df1\n",
    "## data cleaning \n",
    "df2 = df.isnull().sum()\n",
    "df2\n",
    "df3 = df.isna().sum()\n",
    "df3"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "id": "d55d38e1-87df-43ed-86b1-4aab517ac809",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>order_no</th>\n",
       "      <th>Customer_ID</th>\n",
       "      <th>Product_ID</th>\n",
       "      <th>Transaction_ID</th>\n",
       "      <th>Purchase_quantity</th>\n",
       "      <th>Average_values</th>\n",
       "      <th>Most_Frequent_Category</th>\n",
       "      <th>Time_Between_Purchases</th>\n",
       "      <th>Region</th>\n",
       "      <th>Churn_Probability</th>\n",
       "      <th>Lifetime_Value</th>\n",
       "      <th>Launch_Date</th>\n",
       "      <th>Peak_Sales_Date</th>\n",
       "      <th>Season</th>\n",
       "      <th>Preferred_Purchase_Times</th>\n",
       "      <th>Retention_Strategy</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>CUST_9HOS83</td>\n",
       "      <td>PROD_IK97D1</td>\n",
       "      <td>TRANS_II1DZG</td>\n",
       "      <td>17</td>\n",
       "      <td>172.57</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>45</td>\n",
       "      <td>South America</td>\n",
       "      <td>0.98</td>\n",
       "      <td>952.81</td>\n",
       "      <td>2020-03-14</td>\n",
       "      <td>2023-09-11</td>\n",
       "      <td>Winter</td>\n",
       "      <td>Afternoon</td>\n",
       "      <td>Loyalty Program</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>CUST_AJU17N</td>\n",
       "      <td>PROD_UNN7KP</td>\n",
       "      <td>TRANS_9HJF7I</td>\n",
       "      <td>10</td>\n",
       "      <td>64.89</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>6</td>\n",
       "      <td>South America</td>\n",
       "      <td>0.66</td>\n",
       "      <td>5427.51</td>\n",
       "      <td>2022-10-15</td>\n",
       "      <td>2023-01-02</td>\n",
       "      <td>Spring</td>\n",
       "      <td>Afternoon</td>\n",
       "      <td>Discount</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>CUST_11XNYF</td>\n",
       "      <td>PROD_0XEW2W</td>\n",
       "      <td>TRANS_OT96OM</td>\n",
       "      <td>3</td>\n",
       "      <td>120.38</td>\n",
       "      <td>Sports</td>\n",
       "      <td>23</td>\n",
       "      <td>Asia</td>\n",
       "      <td>0.60</td>\n",
       "      <td>3994.80</td>\n",
       "      <td>2021-11-30</td>\n",
       "      <td>2023-04-06</td>\n",
       "      <td>Winter</td>\n",
       "      <td>Evening</td>\n",
       "      <td>Loyalty Program</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>CUST_IGH8G3</td>\n",
       "      <td>PROD_3IIAJN</td>\n",
       "      <td>TRANS_45V00G</td>\n",
       "      <td>12</td>\n",
       "      <td>70.34</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>5</td>\n",
       "      <td>North America</td>\n",
       "      <td>0.78</td>\n",
       "      <td>4880.01</td>\n",
       "      <td>2022-03-20</td>\n",
       "      <td>2023-03-23</td>\n",
       "      <td>Spring</td>\n",
       "      <td>Evening</td>\n",
       "      <td>Discount</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>CUST_OK6PUM</td>\n",
       "      <td>PROD_VMIWD2</td>\n",
       "      <td>TRANS_ZAK760</td>\n",
       "      <td>18</td>\n",
       "      <td>42.39</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>10</td>\n",
       "      <td>North America</td>\n",
       "      <td>0.52</td>\n",
       "      <td>8557.70</td>\n",
       "      <td>2022-11-09</td>\n",
       "      <td>2023-10-28</td>\n",
       "      <td>Spring</td>\n",
       "      <td>Morning</td>\n",
       "      <td>Discount</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9995</th>\n",
       "      <td>9995</td>\n",
       "      <td>CUST_BIH0QW</td>\n",
       "      <td>PROD_AAPCHD</td>\n",
       "      <td>TRANS_EP2EGL</td>\n",
       "      <td>15</td>\n",
       "      <td>162.51</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>72</td>\n",
       "      <td>Europe</td>\n",
       "      <td>0.84</td>\n",
       "      <td>1154.61</td>\n",
       "      <td>2022-03-04</td>\n",
       "      <td>2023-02-10</td>\n",
       "      <td>Winter</td>\n",
       "      <td>Evening</td>\n",
       "      <td>Loyalty Program</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9996</th>\n",
       "      <td>9996</td>\n",
       "      <td>CUST_DWJAD2</td>\n",
       "      <td>PROD_XWJQE5</td>\n",
       "      <td>TRANS_X7OPB7</td>\n",
       "      <td>18</td>\n",
       "      <td>63.02</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>68</td>\n",
       "      <td>Europe</td>\n",
       "      <td>0.03</td>\n",
       "      <td>593.22</td>\n",
       "      <td>2021-08-21</td>\n",
       "      <td>2023-02-06</td>\n",
       "      <td>Spring</td>\n",
       "      <td>Morning</td>\n",
       "      <td>Loyalty Program</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9997</th>\n",
       "      <td>9997</td>\n",
       "      <td>CUST_43HBYL</td>\n",
       "      <td>PROD_PL3BU5</td>\n",
       "      <td>TRANS_VSZM3Y</td>\n",
       "      <td>15</td>\n",
       "      <td>116.80</td>\n",
       "      <td>Home</td>\n",
       "      <td>72</td>\n",
       "      <td>Asia</td>\n",
       "      <td>0.61</td>\n",
       "      <td>4676.35</td>\n",
       "      <td>2020-09-13</td>\n",
       "      <td>2023-05-05</td>\n",
       "      <td>Spring</td>\n",
       "      <td>Evening</td>\n",
       "      <td>Discount</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9998</th>\n",
       "      <td>9998</td>\n",
       "      <td>CUST_0SX4MD</td>\n",
       "      <td>PROD_X5O49V</td>\n",
       "      <td>TRANS_B2YCHY</td>\n",
       "      <td>12</td>\n",
       "      <td>144.21</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>38</td>\n",
       "      <td>North America</td>\n",
       "      <td>0.05</td>\n",
       "      <td>6850.85</td>\n",
       "      <td>2020-01-26</td>\n",
       "      <td>2023-08-03</td>\n",
       "      <td>Summer</td>\n",
       "      <td>Morning</td>\n",
       "      <td>Discount</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9999</th>\n",
       "      <td>9999</td>\n",
       "      <td>CUST_U1AP5I</td>\n",
       "      <td>PROD_CTS1GQ</td>\n",
       "      <td>TRANS_IBPVC5</td>\n",
       "      <td>3</td>\n",
       "      <td>91.32</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>6</td>\n",
       "      <td>Europe</td>\n",
       "      <td>0.67</td>\n",
       "      <td>1549.00</td>\n",
       "      <td>2021-04-17</td>\n",
       "      <td>2023-01-25</td>\n",
       "      <td>Fall</td>\n",
       "      <td>Morning</td>\n",
       "      <td>Discount</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10000 rows × 16 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      order_no  Customer_ID   Product_ID Transaction_ID  Purchase_quantity  \\\n",
       "0            0  CUST_9HOS83  PROD_IK97D1   TRANS_II1DZG                 17   \n",
       "1            1  CUST_AJU17N  PROD_UNN7KP   TRANS_9HJF7I                 10   \n",
       "2            2  CUST_11XNYF  PROD_0XEW2W   TRANS_OT96OM                  3   \n",
       "3            3  CUST_IGH8G3  PROD_3IIAJN   TRANS_45V00G                 12   \n",
       "4            4  CUST_OK6PUM  PROD_VMIWD2   TRANS_ZAK760                 18   \n",
       "...        ...          ...          ...            ...                ...   \n",
       "9995      9995  CUST_BIH0QW  PROD_AAPCHD   TRANS_EP2EGL                 15   \n",
       "9996      9996  CUST_DWJAD2  PROD_XWJQE5   TRANS_X7OPB7                 18   \n",
       "9997      9997  CUST_43HBYL  PROD_PL3BU5   TRANS_VSZM3Y                 15   \n",
       "9998      9998  CUST_0SX4MD  PROD_X5O49V   TRANS_B2YCHY                 12   \n",
       "9999      9999  CUST_U1AP5I  PROD_CTS1GQ   TRANS_IBPVC5                  3   \n",
       "\n",
       "      Average_values Most_Frequent_Category  Time_Between_Purchases  \\\n",
       "0             172.57            Electronics                      45   \n",
       "1              64.89               Clothing                       6   \n",
       "2             120.38                 Sports                      23   \n",
       "3              70.34               Clothing                       5   \n",
       "4              42.39            Electronics                      10   \n",
       "...              ...                    ...                     ...   \n",
       "9995          162.51               Clothing                      72   \n",
       "9996           63.02               Clothing                      68   \n",
       "9997          116.80                   Home                      72   \n",
       "9998          144.21            Electronics                      38   \n",
       "9999           91.32            Electronics                       6   \n",
       "\n",
       "             Region  Churn_Probability  Lifetime_Value Launch_Date  \\\n",
       "0     South America               0.98          952.81  2020-03-14   \n",
       "1     South America               0.66         5427.51  2022-10-15   \n",
       "2              Asia               0.60         3994.80  2021-11-30   \n",
       "3     North America               0.78         4880.01  2022-03-20   \n",
       "4     North America               0.52         8557.70  2022-11-09   \n",
       "...             ...                ...             ...         ...   \n",
       "9995         Europe               0.84         1154.61  2022-03-04   \n",
       "9996         Europe               0.03          593.22  2021-08-21   \n",
       "9997           Asia               0.61         4676.35  2020-09-13   \n",
       "9998  North America               0.05         6850.85  2020-01-26   \n",
       "9999         Europe               0.67         1549.00  2021-04-17   \n",
       "\n",
       "     Peak_Sales_Date  Season Preferred_Purchase_Times Retention_Strategy  \n",
       "0         2023-09-11  Winter                Afternoon    Loyalty Program  \n",
       "1         2023-01-02  Spring                Afternoon           Discount  \n",
       "2         2023-04-06  Winter                  Evening    Loyalty Program  \n",
       "3         2023-03-23  Spring                  Evening           Discount  \n",
       "4         2023-10-28  Spring                  Morning           Discount  \n",
       "...              ...     ...                      ...                ...  \n",
       "9995      2023-02-10  Winter                  Evening    Loyalty Program  \n",
       "9996      2023-02-06  Spring                  Morning    Loyalty Program  \n",
       "9997      2023-05-05  Spring                  Evening           Discount  \n",
       "9998      2023-08-03  Summer                  Morning           Discount  \n",
       "9999      2023-01-25    Fall                  Morning           Discount  \n",
       "\n",
       "[10000 rows x 16 columns]"
      ]
     },
     "execution_count": 63,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "## Renaming columns \n",
    "\n",
    "df_rename = df.rename(columns = {'Average_Order_Value':'Average_values','Purchase_Frequency':'Purchase_quantity'})\n",
    "df_rename\n",
    "\n",
    "df_rename1 = df_rename.drop(columns = ['Unnamed: 0.1','Unnamed: 0'])\n",
    "df_rename1\n",
    "df_rename2 =  df_rename1.drop(columns = 'split_text')\n",
    "df_rename2 "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 68,
   "id": "cf3aeaf5-2fa4-4758-9737-65b4e6c1c39c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>order_no</th>\n",
       "      <th>customer_id</th>\n",
       "      <th>product_id</th>\n",
       "      <th>transaction_id</th>\n",
       "      <th>purchase_quantity</th>\n",
       "      <th>average_values</th>\n",
       "      <th>most_frequent</th>\n",
       "      <th>time_between_purchases</th>\n",
       "      <th>region</th>\n",
       "      <th>churn_probability</th>\n",
       "      <th>lifetime_value</th>\n",
       "      <th>launch_date</th>\n",
       "      <th>peak_sales_date</th>\n",
       "      <th>season</th>\n",
       "      <th>preferred_purchase_times</th>\n",
       "      <th>retention_strategy</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>CUST_9HOS83</td>\n",
       "      <td>PROD_IK97D1</td>\n",
       "      <td>TRANS_II1DZG</td>\n",
       "      <td>17</td>\n",
       "      <td>172.57</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>45</td>\n",
       "      <td>South America</td>\n",
       "      <td>0.98</td>\n",
       "      <td>952.81</td>\n",
       "      <td>2020-03-14</td>\n",
       "      <td>2023-09-11</td>\n",
       "      <td>Winter</td>\n",
       "      <td>Afternoon</td>\n",
       "      <td>Loyalty Program</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>CUST_AJU17N</td>\n",
       "      <td>PROD_UNN7KP</td>\n",
       "      <td>TRANS_9HJF7I</td>\n",
       "      <td>10</td>\n",
       "      <td>64.89</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>6</td>\n",
       "      <td>South America</td>\n",
       "      <td>0.66</td>\n",
       "      <td>5427.51</td>\n",
       "      <td>2022-10-15</td>\n",
       "      <td>2023-01-02</td>\n",
       "      <td>Spring</td>\n",
       "      <td>Afternoon</td>\n",
       "      <td>Discount</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>CUST_11XNYF</td>\n",
       "      <td>PROD_0XEW2W</td>\n",
       "      <td>TRANS_OT96OM</td>\n",
       "      <td>3</td>\n",
       "      <td>120.38</td>\n",
       "      <td>Sports</td>\n",
       "      <td>23</td>\n",
       "      <td>Asia</td>\n",
       "      <td>0.60</td>\n",
       "      <td>3994.80</td>\n",
       "      <td>2021-11-30</td>\n",
       "      <td>2023-04-06</td>\n",
       "      <td>Winter</td>\n",
       "      <td>Evening</td>\n",
       "      <td>Loyalty Program</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>CUST_IGH8G3</td>\n",
       "      <td>PROD_3IIAJN</td>\n",
       "      <td>TRANS_45V00G</td>\n",
       "      <td>12</td>\n",
       "      <td>70.34</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>5</td>\n",
       "      <td>North America</td>\n",
       "      <td>0.78</td>\n",
       "      <td>4880.01</td>\n",
       "      <td>2022-03-20</td>\n",
       "      <td>2023-03-23</td>\n",
       "      <td>Spring</td>\n",
       "      <td>Evening</td>\n",
       "      <td>Discount</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>CUST_OK6PUM</td>\n",
       "      <td>PROD_VMIWD2</td>\n",
       "      <td>TRANS_ZAK760</td>\n",
       "      <td>18</td>\n",
       "      <td>42.39</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>10</td>\n",
       "      <td>North America</td>\n",
       "      <td>0.52</td>\n",
       "      <td>8557.70</td>\n",
       "      <td>2022-11-09</td>\n",
       "      <td>2023-10-28</td>\n",
       "      <td>Spring</td>\n",
       "      <td>Morning</td>\n",
       "      <td>Discount</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9995</th>\n",
       "      <td>9995</td>\n",
       "      <td>CUST_BIH0QW</td>\n",
       "      <td>PROD_AAPCHD</td>\n",
       "      <td>TRANS_EP2EGL</td>\n",
       "      <td>15</td>\n",
       "      <td>162.51</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>72</td>\n",
       "      <td>Europe</td>\n",
       "      <td>0.84</td>\n",
       "      <td>1154.61</td>\n",
       "      <td>2022-03-04</td>\n",
       "      <td>2023-02-10</td>\n",
       "      <td>Winter</td>\n",
       "      <td>Evening</td>\n",
       "      <td>Loyalty Program</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9996</th>\n",
       "      <td>9996</td>\n",
       "      <td>CUST_DWJAD2</td>\n",
       "      <td>PROD_XWJQE5</td>\n",
       "      <td>TRANS_X7OPB7</td>\n",
       "      <td>18</td>\n",
       "      <td>63.02</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>68</td>\n",
       "      <td>Europe</td>\n",
       "      <td>0.03</td>\n",
       "      <td>593.22</td>\n",
       "      <td>2021-08-21</td>\n",
       "      <td>2023-02-06</td>\n",
       "      <td>Spring</td>\n",
       "      <td>Morning</td>\n",
       "      <td>Loyalty Program</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9997</th>\n",
       "      <td>9997</td>\n",
       "      <td>CUST_43HBYL</td>\n",
       "      <td>PROD_PL3BU5</td>\n",
       "      <td>TRANS_VSZM3Y</td>\n",
       "      <td>15</td>\n",
       "      <td>116.80</td>\n",
       "      <td>Home</td>\n",
       "      <td>72</td>\n",
       "      <td>Asia</td>\n",
       "      <td>0.61</td>\n",
       "      <td>4676.35</td>\n",
       "      <td>2020-09-13</td>\n",
       "      <td>2023-05-05</td>\n",
       "      <td>Spring</td>\n",
       "      <td>Evening</td>\n",
       "      <td>Discount</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9998</th>\n",
       "      <td>9998</td>\n",
       "      <td>CUST_0SX4MD</td>\n",
       "      <td>PROD_X5O49V</td>\n",
       "      <td>TRANS_B2YCHY</td>\n",
       "      <td>12</td>\n",
       "      <td>144.21</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>38</td>\n",
       "      <td>North America</td>\n",
       "      <td>0.05</td>\n",
       "      <td>6850.85</td>\n",
       "      <td>2020-01-26</td>\n",
       "      <td>2023-08-03</td>\n",
       "      <td>Summer</td>\n",
       "      <td>Morning</td>\n",
       "      <td>Discount</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9999</th>\n",
       "      <td>9999</td>\n",
       "      <td>CUST_U1AP5I</td>\n",
       "      <td>PROD_CTS1GQ</td>\n",
       "      <td>TRANS_IBPVC5</td>\n",
       "      <td>3</td>\n",
       "      <td>91.32</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>6</td>\n",
       "      <td>Europe</td>\n",
       "      <td>0.67</td>\n",
       "      <td>1549.00</td>\n",
       "      <td>2021-04-17</td>\n",
       "      <td>2023-01-25</td>\n",
       "      <td>Fall</td>\n",
       "      <td>Morning</td>\n",
       "      <td>Discount</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10000 rows × 16 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      order_no  customer_id   product_id transaction_id  purchase_quantity  \\\n",
       "0            0  CUST_9HOS83  PROD_IK97D1   TRANS_II1DZG                 17   \n",
       "1            1  CUST_AJU17N  PROD_UNN7KP   TRANS_9HJF7I                 10   \n",
       "2            2  CUST_11XNYF  PROD_0XEW2W   TRANS_OT96OM                  3   \n",
       "3            3  CUST_IGH8G3  PROD_3IIAJN   TRANS_45V00G                 12   \n",
       "4            4  CUST_OK6PUM  PROD_VMIWD2   TRANS_ZAK760                 18   \n",
       "...        ...          ...          ...            ...                ...   \n",
       "9995      9995  CUST_BIH0QW  PROD_AAPCHD   TRANS_EP2EGL                 15   \n",
       "9996      9996  CUST_DWJAD2  PROD_XWJQE5   TRANS_X7OPB7                 18   \n",
       "9997      9997  CUST_43HBYL  PROD_PL3BU5   TRANS_VSZM3Y                 15   \n",
       "9998      9998  CUST_0SX4MD  PROD_X5O49V   TRANS_B2YCHY                 12   \n",
       "9999      9999  CUST_U1AP5I  PROD_CTS1GQ   TRANS_IBPVC5                  3   \n",
       "\n",
       "      average_values most_frequent  time_between_purchases         region  \\\n",
       "0             172.57   Electronics                      45  South America   \n",
       "1              64.89      Clothing                       6  South America   \n",
       "2             120.38        Sports                      23           Asia   \n",
       "3              70.34      Clothing                       5  North America   \n",
       "4              42.39   Electronics                      10  North America   \n",
       "...              ...           ...                     ...            ...   \n",
       "9995          162.51      Clothing                      72         Europe   \n",
       "9996           63.02      Clothing                      68         Europe   \n",
       "9997          116.80          Home                      72           Asia   \n",
       "9998          144.21   Electronics                      38  North America   \n",
       "9999           91.32   Electronics                       6         Europe   \n",
       "\n",
       "      churn_probability  lifetime_value launch_date peak_sales_date  season  \\\n",
       "0                  0.98          952.81  2020-03-14      2023-09-11  Winter   \n",
       "1                  0.66         5427.51  2022-10-15      2023-01-02  Spring   \n",
       "2                  0.60         3994.80  2021-11-30      2023-04-06  Winter   \n",
       "3                  0.78         4880.01  2022-03-20      2023-03-23  Spring   \n",
       "4                  0.52         8557.70  2022-11-09      2023-10-28  Spring   \n",
       "...                 ...             ...         ...             ...     ...   \n",
       "9995               0.84         1154.61  2022-03-04      2023-02-10  Winter   \n",
       "9996               0.03          593.22  2021-08-21      2023-02-06  Spring   \n",
       "9997               0.61         4676.35  2020-09-13      2023-05-05  Spring   \n",
       "9998               0.05         6850.85  2020-01-26      2023-08-03  Summer   \n",
       "9999               0.67         1549.00  2021-04-17      2023-01-25    Fall   \n",
       "\n",
       "     preferred_purchase_times retention_strategy  \n",
       "0                   Afternoon    Loyalty Program  \n",
       "1                   Afternoon           Discount  \n",
       "2                     Evening    Loyalty Program  \n",
       "3                     Evening           Discount  \n",
       "4                     Morning           Discount  \n",
       "...                       ...                ...  \n",
       "9995                  Evening    Loyalty Program  \n",
       "9996                  Morning    Loyalty Program  \n",
       "9997                  Evening           Discount  \n",
       "9998                  Morning           Discount  \n",
       "9999                  Morning           Discount  \n",
       "\n",
       "[10000 rows x 16 columns]"
      ]
     },
     "execution_count": 68,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "## replacing values \n",
    "df2 = df_rename2.rename(columns = {'Most_Frequent_Category':'Most_Frequent'})\n",
    "df2\n",
    "df2.columns\n",
    "df2.columns = df2.columns.str.lower()\n",
    "df2.columns\n",
    "df2 "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 75,
   "id": "e28543ce-79de-4c15-a381-71efa53f75c4",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "engine sucessfully active\n"
     ]
    }
   ],
   "source": [
    "## exporting data to sql \n",
    "import pymysql\n",
    "from sqlalchemy import create_engine\n",
    "\n",
    "engine_mysql = create_engine(\"mysql+pymysql://root:2005@127.0.0.1:3306/sales_insights\")\n",
    "\n",
    "try:\n",
    "    create_engine\n",
    "    print(\"engine sucessfully active\")\n",
    "except:\n",
    "    print(\"unable to connect\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 77,
   "id": "51d3e3c4-9fd7-497b-a7b2-78a6a38c22dc",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "10000"
      ]
     },
     "execution_count": 77,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df2.to_sql('sales_insights',con=engine_mysql,if_exists='append',index = False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 79,
   "id": "06610324-24eb-48d0-bab9-3d177799f599",
   "metadata": {},
   "outputs": [],
   "source": [
    "df2.to_excel('C:\\\\Users\\\\Admin\\\\OneDrive\\\\vk_salesdata.xlsx',index=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "78b50959-f4aa-4e3f-ba82-513ce5a7b1c7",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
